<?xml version="1.0" encoding="UTF-8"?>
<upgrade dataSourceName="TRADE" databaseVersion="20.00">
	<sql>
	<![CDATA[
	
	ALTER TABLE TRADE
ADD SELLER_CAN_RATE SMALLINT
DEFAULT 0 
NOT NULL ;

	ALTER TABLE TRADE
ADD ITEM_TITLE VARCHAR(400) CHARACTER SET UTF8 
DEFAULT ''
NOT NULL 
COLLATE UTF8 ;

ALTER TABLE TRADE
ADD CAN_RATE SMALLINT
DEFAULT 0 
NOT NULL ;

ALTER TABLE TRADE
ADD REFUND_STATUS INTEGER
DEFAULT 0
NOT NULL ;

ALTER TABLE TRADE
ADD USER_INFO1 VARCHAR(400) CHARACTER SET UTF8 
DEFAULT ''
NOT NULL 
COLLATE UTF8    ;

ALTER TABLE TRADE
ADD USER_INFO2 VARCHAR(400) CHARACTER SET UTF8
DEFAULT ''
NOT NULL 
COLLATE UTF8   ;

ALTER TABLE TRADE
ADD USER_INFO3 VARCHAR(400) CHARACTER SET UTF8
DEFAULT ''
NOT NULL 
COLLATE UTF8  ;

ALTER TABLE TRADE
ADD USER_INFO4 VARCHAR(400) CHARACTER SET UTF8
DEFAULT ''
NOT NULL
COLLATE UTF8  ;

update RDB$RELATION_FIELDS set
RDB$NULL_FLAG = 1
where (RDB$FIELD_NAME = 'IS_INVOICE_PRINT') and
(RDB$RELATION_NAME = 'TRADEEX');

ALTER TABLE TRADEEX ADD IBE$$TEMP_COLUMN
 SMALLINT DEFAULT 0;

UPDATE RDB$RELATION_FIELDS F1
SET
F1.RDB$DEFAULT_VALUE = (SELECT F2.RDB$DEFAULT_VALUE
                         FROM RDB$RELATION_FIELDS F2
                         WHERE (F2.RDB$RELATION_NAME = 'TRADEEX') AND
                               (F2.RDB$FIELD_NAME = 'IBE$$TEMP_COLUMN')),
F1.RDB$DEFAULT_SOURCE = (SELECT F3.RDB$DEFAULT_SOURCE FROM RDB$RELATION_FIELDS F3
                         WHERE (F3.RDB$RELATION_NAME = 'TRADEEX') AND
                               (F3.RDB$FIELD_NAME = 'IBE$$TEMP_COLUMN'))
WHERE (F1.RDB$RELATION_NAME = 'TRADEEX') AND
      (F1.RDB$FIELD_NAME = 'IS_INVOICE_PRINT');
ALTER TABLE TRADEEX DROP IBE$$TEMP_COLUMN;

update RDB$RELATION_FIELDS set
RDB$NULL_FLAG = 1
where (RDB$FIELD_NAME = 'IS_EXPRESS_PRINT') and
(RDB$RELATION_NAME = 'TRADEEX');

ALTER TABLE TRADEEX ADD IBE$$TEMP_COLUMN
 SMALLINT DEFAULT 0;

UPDATE RDB$RELATION_FIELDS F1
SET
F1.RDB$DEFAULT_VALUE = (SELECT F2.RDB$DEFAULT_VALUE
                         FROM RDB$RELATION_FIELDS F2
                         WHERE (F2.RDB$RELATION_NAME = 'TRADEEX') AND
                               (F2.RDB$FIELD_NAME = 'IBE$$TEMP_COLUMN')),
F1.RDB$DEFAULT_SOURCE = (SELECT F3.RDB$DEFAULT_SOURCE FROM RDB$RELATION_FIELDS F3
                         WHERE (F3.RDB$RELATION_NAME = 'TRADEEX') AND
                               (F3.RDB$FIELD_NAME = 'IBE$$TEMP_COLUMN'))
WHERE (F1.RDB$RELATION_NAME = 'TRADEEX') AND
      (F1.RDB$FIELD_NAME = 'IS_EXPRESS_PRINT');
ALTER TABLE TRADEEX DROP IBE$$TEMP_COLUMN;

update RDB$RELATION_FIELDS set
RDB$NULL_FLAG = 1
where (RDB$FIELD_NAME = 'BUYER_FLAG') and
(RDB$RELATION_NAME = 'TRADE');

ALTER TABLE TRADE ADD IBE$$TEMP_COLUMN
 INTEGER DEFAULT '';

UPDATE RDB$RELATION_FIELDS F1
SET
F1.RDB$DEFAULT_VALUE = (SELECT F2.RDB$DEFAULT_VALUE
                         FROM RDB$RELATION_FIELDS F2
                         WHERE (F2.RDB$RELATION_NAME = 'TRADE') AND
                               (F2.RDB$FIELD_NAME = 'IBE$$TEMP_COLUMN')),
F1.RDB$DEFAULT_SOURCE = (SELECT F3.RDB$DEFAULT_SOURCE FROM RDB$RELATION_FIELDS F3
                         WHERE (F3.RDB$RELATION_NAME = 'TRADE') AND
                               (F3.RDB$FIELD_NAME = 'IBE$$TEMP_COLUMN'))
WHERE (F1.RDB$RELATION_NAME = 'TRADE') AND
      (F1.RDB$FIELD_NAME = 'BUYER_FLAG');

ALTER TABLE TRADE DROP IBE$$TEMP_COLUMN;

update RDB$RELATION_FIELDS set
RDB$NULL_FLAG = 1
where (RDB$FIELD_NAME = 'SELLER_FLAG') and
(RDB$RELATION_NAME = 'TRADE');

ALTER TABLE TRADE ADD IBE$$TEMP_COLUMN
 INTEGER DEFAULT '';

UPDATE RDB$RELATION_FIELDS F1
SET
F1.RDB$DEFAULT_VALUE = (SELECT F2.RDB$DEFAULT_VALUE
                         FROM RDB$RELATION_FIELDS F2
                         WHERE (F2.RDB$RELATION_NAME = 'TRADE') AND
                               (F2.RDB$FIELD_NAME = 'IBE$$TEMP_COLUMN')),
F1.RDB$DEFAULT_SOURCE = (SELECT F3.RDB$DEFAULT_SOURCE FROM RDB$RELATION_FIELDS F3
                         WHERE (F3.RDB$RELATION_NAME = 'TRADE') AND
                               (F3.RDB$FIELD_NAME = 'IBE$$TEMP_COLUMN'))
WHERE (F1.RDB$RELATION_NAME = 'TRADE') AND
      (F1.RDB$FIELD_NAME = 'SELLER_FLAG');

ALTER TABLE TRADE DROP IBE$$TEMP_COLUMN;

update RDB$RELATION_FIELDS set
RDB$NULL_FLAG = 1
where (RDB$FIELD_NAME = 'OUT_SID') and
(RDB$RELATION_NAME = 'TRADEEX');

ALTER TABLE TRADEEX ADD IBE$$TEMP_COLUMN
 VARCHAR(1) DEFAULT '';

UPDATE RDB$RELATION_FIELDS F1
SET
F1.RDB$DEFAULT_VALUE = (SELECT F2.RDB$DEFAULT_VALUE
                         FROM RDB$RELATION_FIELDS F2
                         WHERE (F2.RDB$RELATION_NAME = 'TRADEEX') AND
                               (F2.RDB$FIELD_NAME = 'IBE$$TEMP_COLUMN')),
F1.RDB$DEFAULT_SOURCE = (SELECT F3.RDB$DEFAULT_SOURCE FROM RDB$RELATION_FIELDS F3
                         WHERE (F3.RDB$RELATION_NAME = 'TRADEEX') AND
                               (F3.RDB$FIELD_NAME = 'IBE$$TEMP_COLUMN'))
WHERE (F1.RDB$RELATION_NAME = 'TRADEEX') AND
      (F1.RDB$FIELD_NAME = 'OUT_SID');

ALTER TABLE TRADEEX DROP IBE$$TEMP_COLUMN;


CREATE INDEX TRADE_ITEM_TITLE_ASC  ON TRADE (ITEM_TITLE);

CREATE DESCENDING INDEX TRADE_ITEM_TITLE_DESC ON TRADE (ITEM_TITLE); 

CREATE INDEX TRADE_REFUND_STATUS_ASC  ON TRADE (REFUND_STATUS);

CREATE DESCENDING INDEX TRADE_REFUND_STATUS_DESC ON TRADE (REFUND_STATUS); 

CREATE INDEX TRADE_BUYER_NICK_ASC  ON TRADE (BUYER_NICK);

CREATE DESCENDING INDEX TRADE_BUYER_NICK_DESC ON TRADE (BUYER_NICK); 

CREATE INDEX TRADE_PRICE_ASC  ON TRADE (PRICE);

CREATE DESCENDING INDEX TRADE_PRICE_DESC ON TRADE (PRICE); 

CREATE INDEX TRADE_POST_FEE_ASC  ON TRADE (POST_FEE);

CREATE DESCENDING INDEX TRADE_POST_FEE_DESC ON TRADE (POST_FEE); 

CREATE INDEX TRADE_SELLER_FLAG_ASC  ON TRADE (SELLER_FLAG);

CREATE DESCENDING INDEX TRADE_SELLER_FLAG_DESC ON TRADE (SELLER_FLAG); 

CREATE INDEX TRADE_PAYMENT_ASC  ON TRADE (PAYMENT);

CREATE DESCENDING INDEX TRADE_PAYMENT_DESC ON TRADE (PAYMENT); 

CREATE INDEX TRADE_NUM_ASC  ON TRADE (NUM);

CREATE DESCENDING INDEX TRADE_NUM_DESC ON TRADE (NUM); 

CREATE INDEX TRADE_TRADE_TYPE_ASC  ON TRADE (TRADE_TYPE);

CREATE DESCENDING INDEX TRADE_TRADE_TYPE_DESC ON TRADE (TRADE_TYPE); 

CREATE INDEX TRADE_COD_STATUS_ASC  ON TRADE (COD_STATUS);

CREATE DESCENDING INDEX TRADE_COD_STATUS_DESC ON TRADE (COD_STATUS); 

CREATE INDEX TRADE_BUYER_RATE_ASC  ON TRADE (BUYER_RATE);

CREATE DESCENDING INDEX TRADE_BUYER_RATE_DESC ON TRADE (BUYER_RATE); 

CREATE INDEX TRADE_CREATED_ASC  ON TRADE (CREATED);

CREATE DESCENDING INDEX TRADE_CREATED_DESC ON TRADE (CREATED); 

CREATE INDEX TRADE_SELLER_MEMO_ASC  ON TRADE (SELLER_MEMO);

CREATE DESCENDING INDEX TRADE_SELLER_MEMO_DESC ON TRADE (SELLER_MEMO); 

CREATE INDEX TRADE_BUYER_MESSAGE_ASC  ON TRADE (BUYER_MESSAGE);

CREATE DESCENDING INDEX TRADE_BUYER_MESSAGE_DESC ON TRADE (BUYER_MESSAGE); 

CREATE INDEX TRADE_CONSIGN_TIME_ASC  ON TRADE (CONSIGN_TIME);

CREATE DESCENDING INDEX TRADE_CONSIGN_TIME_DESC ON TRADE (CONSIGN_TIME); 

CREATE INDEX TRADE_RECEIVER_NAME_ASC  ON TRADE (RECEIVER_NAME);

CREATE DESCENDING INDEX TRADE_RECEIVER_NAME_DESC ON TRADE (RECEIVER_NAME); 

CREATE INDEX TRADE_RECEIVER_STATE_ASC  ON TRADE (RECEIVER_STATE);

CREATE DESCENDING INDEX TRADE_RECEIVER_STATE_DESC ON TRADE (RECEIVER_STATE); 

CREATE INDEX TRADE_RECEIVER_CITY_ASC  ON TRADE (RECEIVER_CITY);

CREATE DESCENDING INDEX TRADE_RECEIVER_CITY_DESC ON TRADE (RECEIVER_CITY); 

CREATE INDEX TRADE_RECEIVER_DISTRICT_ASC  ON TRADE (RECEIVER_DISTRICT);

CREATE DESCENDING INDEX TRADE_RECEIVER_DISTRICT_DESC ON TRADE (RECEIVER_DISTRICT); 

CREATE INDEX TRADE_RECEIVER_ADDRESS_ASC  ON TRADE (RECEIVER_ADDRESS);

CREATE DESCENDING INDEX TRADE_RECEIVER_ADDRESS_DESC ON TRADE (RECEIVER_ADDRESS); 

CREATE INDEX TRADE_RECEIVER_ZIP_ASC  ON TRADE (RECEIVER_ZIP);

CREATE DESCENDING INDEX TRADE_RECEIVER_ZIP_DESC ON TRADE (RECEIVER_ZIP); 

CREATE INDEX TRADE_RECEIVER_MOBILE_ASC  ON TRADE (RECEIVER_MOBILE);

CREATE DESCENDING INDEX TRADE_RECEIVER_MOBILE_DESC ON TRADE (RECEIVER_MOBILE); 

CREATE INDEX TRADE_RECEIVER_PHONE_ASC  ON TRADE (RECEIVER_PHONE);

CREATE DESCENDING INDEX TRADE_RECEIVER_PHONE_DESC ON TRADE (RECEIVER_PHONE); 

CREATE INDEX TRADE_PAY_TIME_ASC  ON TRADE (PAY_TIME);

CREATE DESCENDING INDEX TRADE_PAY_TIME_DESC ON TRADE (PAY_TIME); 

CREATE INDEX TRADE_ALIPAY_NO_ASC  ON TRADE (ALIPAY_NO);

CREATE DESCENDING INDEX TRADE_ALIPAY_NO_DESC ON TRADE (ALIPAY_NO); 

CREATE INDEX TRADE_SHIPPING_TYPE_ASC  ON TRADE (SHIPPING_TYPE);

CREATE DESCENDING INDEX TRADE_SHIPPING_TYPE_DESC ON TRADE (SHIPPING_TYPE); 

CREATE INDEX TRADE_BUYER_ALIPAY_NO_ASC  ON TRADE (BUYER_ALIPAY_NO);

CREATE DESCENDING INDEX TRADE_BUYER_ALIPAY_NO_DESC ON TRADE (BUYER_ALIPAY_NO); 

CREATE INDEX TRADEEX_IS_EXPRESS_PRINT_ASC  ON TRADEEX (IS_EXPRESS_PRINT);

CREATE DESCENDING INDEX TRADEEX_IS_EXPRESS_PRINT_DESC ON TRADEEX (IS_EXPRESS_PRINT); 

CREATE INDEX TRADEEX_IS_INVOICE_PRINT_ASC  ON TRADEEX (IS_INVOICE_PRINT);

CREATE DESCENDING INDEX TRADEEX_IS_INVOICE_PRINT_DESC ON TRADEEX (IS_INVOICE_PRINT); 

CREATE INDEX TRADEEX_EXPRESS_PRINT_TIME_ASC  ON TRADEEX (EXPRESS_PRINT_TIME);

CREATE DESCENDING INDEX TRADEEX_EXPRESS_PRINT_TIME_DESC ON TRADEEX (EXPRESS_PRINT_TIME); 

CREATE INDEX TRADEEX_INVOICE_PRINT_TIME_ASC  ON TRADEEX (INVOICE_PRINT_TIME);

CREATE DESCENDING INDEX TRADEEX_INVOICE_PRINT_TIME_DESC ON TRADEEX (INVOICE_PRINT_TIME); 

CREATE INDEX TRADEEX_COMPANY_NAME_ASC  ON TRADEEX (COMPANY_NAME);

CREATE DESCENDING INDEX TRADEEX_COMPANY_NAME_DESC ON TRADEEX (COMPANY_NAME); 

CREATE INDEX TRADEEX_OUT_SID_ASC  ON TRADEEX (OUT_SID);

CREATE DESCENDING INDEX TRADEEX_OUT_SID_DESC ON TRADEEX (OUT_SID); 

CREATE INDEX ORDERS_TID_ASC ON ORDERS (TID);

CREATE DESCENDING INDEX ORDERS_TID_DESC ON ORDERS (TID);

CREATE INDEX ORDERS_TID_ASC ON ORDERS (TID)
	
CREATE DESCENDING INDEX ORDERS_TID_DESC ON ORDERS (TID)

	]]>
	</sql>
</upgrade>